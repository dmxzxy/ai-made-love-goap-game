# 游戏功能框架大纲

## 🎮 核心游戏系统

### 1. 游戏模式
- **多人对战模式**：支持2-4个队伍同时对战
- **实时战略**：即时战斗，无回合限制
- **基地摧毁胜利**：摧毁所有敌方基地获胜

---

## 🤖 AI 智能系统

### 2. GOAP 目标导向行动规划
- **动态规划**：AI根据当前状态自动规划行动序列
- **A*路径搜索**：智能寻路算法
- **前置条件检查**：行动可行性验证
- **效果评估**：行动结果预测

### 3. 行动类型 (7种)
- **寻找目标**：自动搜索敌方单位或建筑
- **移动到敌人**：追击敌方单位
- **攻击敌人**：对敌方单位发起攻击
- **移动到基地**：前往敌方基地
- **攻击基地**：破坏敌方基地
- **撤退**：低血量时自动撤退
- **空闲**：无事可做时的待机状态

---

## ⚔️ 战斗系统

### 4. 单位系统 (8种兵种)
- **战士 (Warrior)**：均衡型近战单位
- **坦克 (Tank)**：高血量防御单位
- **刺客 (Assassin)**：高暴击高闪避单位
- **狙击手 (Sniper)**：超远程精准射手
- **游侠 (Ranger)**：远程速射单位
- **机枪手 (Gunner)**：快速射击单位
- **矿工 (Miner)**：资源采集专用
- **特种兵 (SpecOps)**：精英作战单位

### 5. 兵种克制系统
- **克制关系**：特定兵种对特定目标有伤害加成
- **动态伤害计算**：根据克制关系调整伤害倍率

### 6. 战斗机制
- **攻击冷却**：每个单位独立攻击间隔
- **暴击系统**：随机触发暴击伤害
- **闪避系统**：概率闪避攻击
- **反击机制**：被攻击后可能反击
- **攻击范围判定**：近战/远程攻击距离
- **战斗微操**：
  - 近战单位环绕移动
  - 远程单位保持最佳射程

---

## 🏗️ 建筑系统

### 7. 基地 (Base)
- **单位生产**：自动生产各类单位
- **AI决策中心**：智能选择生产兵种
- **资源管理**：消耗金币生产单位
- **队伍核心**：基地被摧毁则失败

### 8. 防御塔 (Tower, 4种)
- **基础防御塔**：标准攻击塔
- **狙击塔**：远程高伤害塔
- **机枪塔**：快速连射塔
- **激光塔**：穿透攻击塔

### 9. 特殊建筑 (12种)
- **万能工厂 (UniversalFactory)**：可生产多种兵种
- **采矿站 (MiningStation)**：增加资源采集效率
- **兵营 (Barracks)**：快速训练基础单位
- **科技中心 (TechCenter)**：解锁高级单位
- **防御堡垒 (DefenseFortress)**：提供区域防御
- **资源仓库 (ResourceDepot)**：增加金币存储
- **训练场 (TrainingGround)**：提升单位属性
- **侦察站 (ScoutPost)**：扩大视野范围
- **修理站 (RepairStation)**：自动修复建筑
- **能量核心 (PowerCore)**：提升整体效率
- **指挥中心 (CommandCenter)**：协调作战
- **研究所 (ResearchLab)**：研发新技术

### 10. 建筑管理
- **自动建造**：AI根据策略自动建造
- **碰撞检测**：防止建筑重叠
- **建筑升级**：部分建筑可升级
- **建筑上限**：每个队伍有建筑数量限制

---

## 💰 资源系统

### 11. 经济管理
- **金币系统**：主要货币
- **资源点采集**：矿工自动采矿
- **资源自动增长**：被动收入
- **消耗机制**：生产单位和建筑消耗金币

---

## 🎨 视觉效果系统

### 12. 粒子效果
- **子弹轨迹**：远程攻击弹道
- **爆炸效果**：单位死亡爆炸
- **火花效果**：近战攻击火花
- **烟雾效果**：战斗烟雾
- **命中效果**：攻击命中特效

### 13. 伤害数字显示
- **浮动数字**：实时显示伤害值
- **暴击标识**：暴击伤害特殊显示
- **闪避提示**：显示"DODGE"字样
- **颜色区分**：不同类型伤害不同颜色

### 14. 战斗反馈
- **屏幕震动**：重要事件触发震动
- **闪光效果**：受击闪光
- **攻击动画**：攻击时的视觉反馈

---

## 🗺️ 地图与导航

### 15. 地图系统
- **大尺寸地图**：3200×1800像素战场
- **资源点分布**：随机生成资源点
- **基地位置**：四角对称分布

### 16. 摄像机系统
- **自由移动**：鼠标拖拽移动视角
- **缩放功能**：鼠标滚轮缩放
- **屏幕震动**：战斗时的震动效果

### 17. 小地图 (Minimap)
- **全局视野**：显示整个战场
- **单位标记**：不同颜色显示队伍
- **基地标记**：高亮显示基地位置
- **点击导航**：点击小地图快速定位

---

## 🎯 目标与AI决策

### 18. 目标选择系统
- **优先级计算**：根据距离、威胁度、价值评分
- **动态重新评估**：战斗中智能切换目标
- **仇恨系统**：被攻击后提高攻击者优先级
- **目标锁定**：减少频繁切换，保持攻击连贯

### 19. 战术行为
- **反拥挤系统**：
  - 单位碰撞推开
  - 拥挤时自动分散
  - 卡住检测与处理
- **战术走位**：
  - 近战环绕移动
  - 远程保持距离
  - 攻击冷却期微调整
- **智能撤退**：低血量自动撤离
- **团队协作**：多单位集火攻击

---

## 📊 统计与数据

### 20. 战斗统计
- **击杀统计**：每个队伍击杀数
- **伤害统计**：造成/承受伤害
- **经济统计**：金币消耗/采集
- **建筑统计**：建筑建造数量
- **单位统计**：单位生产数量

### 21. 实时数据显示
- **队伍信息**：金币、单位数、建筑数
- **选中单位信息**：
  - 血量、攻击力、攻击速度
  - 移动速度、攻击范围
  - 当前目标、当前行动
- **调试信息**：帧率、单位数量等

---

## 🎮 用户界面

### 22. 开始菜单
- **队伍选择**：选择2-4队伍对战
- **游戏开始**：启动游戏
- **说明展示**：游戏玩法提示

### 23. 游戏HUD
- **队伍状态栏**：显示各队伍状态
- **小地图**：右下角显示
- **选中信息面板**：显示选中单位/建筑详情
- **战斗通知**：重要事件提示

### 24. 游戏结束界面
- **胜利队伍显示**：高亮显示获胜方
- **战斗统计**：显示各队伍数据
- **重新开始选项**：快速重启游戏

---

## 🎵 交互控制

### 25. 鼠标控制
- **左键选择**：选中单位/建筑
- **中键拖拽**：移动摄像机
- **滚轮缩放**：调整视野
- **小地图点击**：快速导航

### 26. 键盘控制
- **M键**：切换小地图显示
- **R键**：重新开始游戏（游戏结束后）
- **ESC键**：返回主菜单（未实现）

---

## 🔧 性能优化

### 27. 渲染优化
- **视锥剔除**：只渲染可见单位
- **批量渲染**：减少绘制调用
- **特效限制**：控制粒子数量

### 28. AI优化
- **规划冷却**：避免每帧规划
- **目标评估冷却**：减少计算频率
- **分帧更新**：分散计算负载

### 29. 日志优化
- **减少打印**：只打印关键信息
- **条件日志**：仅调试模式输出

---

## 🐛 调试系统

### 30. 调试功能
- **选中单位调试**：显示详细状态
- **GOAP计划可视化**：显示当前行动计划
- **帧率显示**：实时性能监控
- **单位数量统计**：各队伍单位数
- **资源监控**：实时金币数量

---

## 🚀 未来扩展方向

### 31. 待完善功能
- **指挥官系统**：玩家直接控制
- **更多兵种**：新单位类型
- **技能系统**：单位主动技能
- **装备系统**：单位装备强化
- **地图编辑器**：自定义地图
- **多人联机**：真人对战
- **战役模式**：剧情关卡
- **成就系统**：目标解锁

---

## 📝 技术栈

### 32. 开发环境
- **引擎**：LÖVE2D (Lua游戏引擎)
- **语言**：Lua 5.1+
- **平台**：跨平台 (Windows/macOS/Linux)

### 33. 核心算法
- **GOAP (Goal-Oriented Action Planning)**：目标导向规划
- **A\* 算法**：路径搜索
- **碰撞检测**：圆形碰撞
- **向量运算**：移动和导航计算

---

## 📐 游戏参数

### 34. 平衡性参数
- **地图尺寸**：3200×1800
- **单位半径**：8-20像素（不同兵种）
- **攻击范围**：50-350像素（近战到远程）
- **移动速度**：80-180像素/秒
- **生产速度**：2-10秒/单位
- **初始金币**：500
- **资源点数量**：10个
- **建筑上限**：每队15个

---

*该文档描述了当前游戏的主要功能模块，为大纲式概览，不包含具体实现细节*
